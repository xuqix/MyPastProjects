#ifndef PE_LOCK_H
#define PE_LOCK_H

BYTE	lpCodeStart[] = {

0xe9, 0xe5, 0x0a, 0x00, 0x00, 0xc7, 0xeb, 0xca, 0xe4, 0xc8, 0xeb, 0xce, 0xc4, 0xbc, 0xfe, 0xbd, 
0xe2, 0xcb, 0xf8, 0xc3, 0xdc, 0xc2, 0xeb, 0x00, 0x4d, 0x65, 0x6e, 0x75, 0x20, 0x45, 0x78, 0x61, 
0x6d, 0x70, 0x6c, 0x65, 0x00, 0x62, 0x75, 0x74, 0x74, 0x6f, 0x6e, 0x00, 0x65, 0x64, 0x69, 0x74, 
0x00, 0xc8, 0xb7, 0x20, 0x20, 0xb6, 0xa8, 0x00, 0xc8, 0xa1, 0x20, 0x20, 0xcf, 0xfb, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x47, 0x65, 0x74, 0x50, 0x72, 0x6f, 0x63, 0x41, 0x64, 0x64, 0x72, 0x65, 0x73, 
0x73, 0x00, 0x4c, 0x6f, 0x61, 0x64, 0x4c, 0x69, 0x62, 0x72, 0x61, 0x72, 0x79, 0x41, 0x00, 0x43, 
0x72, 0x65, 0x61, 0x74, 0x65, 0x57, 0x69, 0x6e, 0x64, 0x6f, 0x77, 0x45, 0x78, 0x41, 0x00, 0x44, 
0x65, 0x66, 0x57, 0x69, 0x6e, 0x64, 0x6f, 0x77, 0x50, 0x72, 0x6f, 0x63, 0x41, 0x00, 0x44, 0x65, 
0x73, 0x74, 0x72, 0x6f, 0x79, 0x57, 0x69, 0x6e, 0x64, 0x6f, 0x77, 0x00, 0x44, 0x69, 0x73, 0x70, 
0x61, 0x74, 0x63, 0x68, 0x4d, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x41, 0x00, 0x47, 0x65, 0x74, 
0x44, 0x6c, 0x67, 0x49, 0x74, 0x65, 0x6d, 0x54, 0x65, 0x78, 0x74, 0x41, 0x00, 0x47, 0x65, 0x74, 
0x4d, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x41, 0x00, 0x4d, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 
0x42, 0x6f, 0x78, 0x41, 0x00, 0x50, 0x6f, 0x73, 0x74, 0x51, 0x75, 0x69, 0x74, 0x4d, 0x65, 0x73, 
0x73, 0x61, 0x67, 0x65, 0x00, 0x52, 0x65, 0x67, 0x69, 0x73, 0x74, 0x65, 0x72, 0x43, 0x6c, 0x61, 
0x73, 0x73, 0x45, 0x78, 0x41, 0x00, 0x53, 0x68, 0x6f, 0x77, 0x57, 0x69, 0x6e, 0x64, 0x6f, 0x77, 
0x00, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6c, 0x61, 0x74, 0x65, 0x41, 0x63, 0x63, 0x65, 0x6c, 0x65, 
0x72, 0x61, 0x74, 0x6f, 0x72, 0x41, 0x00, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6c, 0x61, 0x74, 0x65, 
0x4d, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x00, 0x55, 0x70, 0x64, 0x61, 0x74, 0x65, 0x57, 0x69, 
0x6e, 0x64, 0x6f, 0x77, 0x00, 0x75, 0x73, 0x65, 0x72, 0x33, 0x32, 0x2e, 0x64, 0x6c, 0x6c, 0x00, 
0x00, 0x45, 0x78, 0x69, 0x74, 0x50, 0x72, 0x6f, 0x63, 0x65, 0x73, 0x73, 0x00, 0x47, 0x65, 0x74, 
0x4d, 0x6f, 0x64, 0x75, 0x6c, 0x65, 0x48, 0x61, 0x6e, 0x64, 0x6c, 0x65, 0x41, 0x00, 0x52, 0x74, 
0x6c, 0x5a, 0x65, 0x72, 0x6f, 0x4d, 0x65, 0x6d, 0x6f, 0x72, 0x79, 0x00, 0x6c, 0x73, 0x74, 0x72, 
0x63, 0x6d, 0x70, 0x41, 0x00, 0x53, 0x65, 0x74, 0x46, 0x6f, 0x63, 0x75, 0x73, 0x00, 0x6b, 0x65, 
0x72, 0x6e, 0x65, 0x6c, 0x33, 0x32, 0x2e, 0x64, 0x6c, 0x6c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x55, 0x8b, 0xec, 0x60, 
0x8b, 0x75, 0x08, 0x8b, 0x7d, 0x10, 0x8b, 0x45, 0x0c, 0xff, 0x70, 0x0c, 0x8f, 0x87, 0xb4, 0x00, 
0x00, 0x00, 0xff, 0x70, 0x08, 0x8f, 0x87, 0xb8, 0x00, 0x00, 0x00, 0x50, 0x8f, 0x87, 0xc4, 0x00, 
0x00, 0x00, 0x61, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xc9, 0xc2, 0x10, 0x00, 0x55, 0x8b, 0xec, 0x57, 
0x56, 0x53, 0xe8, 0x00, 0x00, 0x00, 0x00, 0x5b, 0x81, 0xeb, 0x47, 0x14, 0x40, 0x00, 0x55, 0x8d, 
0x83, 0x8a, 0x14, 0x40, 0x00, 0x50, 0x8d, 0x83, 0x0c, 0x14, 0x40, 0x00, 0x50, 0x64, 0xff, 0x35, 
0x00, 0x00, 0x00, 0x00, 0x64, 0x89, 0x25, 0x00, 0x00, 0x00, 0x00, 0x8b, 0x45, 0x08, 0x25, 0x00, 
0x00, 0xff, 0xff, 0xeb, 0x1a, 0x66, 0x81, 0x38, 0x4d, 0x5a, 0x75, 0x0e, 0x8b, 0xf8, 0x03, 0x78, 
0x3c, 0x66, 0x81, 0x3f, 0x50, 0x45, 0x75, 0x02, 0xeb, 0x11, 0x2d, 0x00, 0x00, 0x01, 0x00, 0x3d, 
0x00, 0x00, 0x00, 0x70, 0x73, 0xdf, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x64, 0x8f, 0x05, 0x00, 0x00, 
0x00, 0x00, 0x83, 0xc4, 0x0c, 0x5b, 0x5e, 0x5f, 0xc9, 0xc2, 0x04, 0x00, 0x55, 0x8b, 0xec, 0x83, 
0xc4, 0xf8, 0x60, 0xe8, 0x00, 0x00, 0x00, 0x00, 0x5b, 0x81, 0xeb, 0xb8, 0x14, 0x40, 0x00, 0x55, 
0xff, 0xb3, 0x47, 0x15, 0x40, 0x00, 0xff, 0xb3, 0x0c, 0x14, 0x40, 0x00, 0x64, 0xff, 0x35, 0x00, 
0x00, 0x00, 0x00, 0x64, 0x89, 0x25, 0x00, 0x00, 0x00, 0x00, 0x8b, 0x7d, 0x0c, 0xb9, 0xff, 0xff, 
0xff, 0xff, 0x33, 0xc0, 0xfc, 0xf2, 0xae, 0x2b, 0x7d, 0x0c, 0x89, 0x7d, 0xf8, 0x8b, 0x75, 0x08, 
0x03, 0x76, 0x3c, 0x8b, 0x76, 0x78, 0x03, 0x75, 0x08, 0x8b, 0x5e, 0x20, 0x03, 0x5d, 0x08, 0x33, 
0xd2, 0xeb, 0x1b, 0x56, 0x8b, 0x3b, 0x03, 0x7d, 0x08, 0x8b, 0x75, 0x0c, 0x8b, 0x4d, 0xf8, 0xfc, 
0xf3, 0xa6, 0x0b, 0xc9, 0x75, 0x03, 0x5e, 0xeb, 0x0c, 0x5e, 0x42, 0x83, 0xc3, 0x04, 0x3b, 0x56, 
0x18, 0x72, 0xe0, 0xeb, 0x22, 0x2b, 0x5e, 0x20, 0x2b, 0x5d, 0x08, 0xd1, 0xeb, 0x03, 0x5e, 0x24, 
0x03, 0x5d, 0x08, 0x0f, 0xb7, 0x03, 0xc1, 0xe0, 0x02, 0x03, 0x46, 0x1c, 0x03, 0x45, 0x08, 0x8b, 
0x00, 0x03, 0x45, 0x08, 0x89, 0x45, 0xfc, 0x64, 0x8f, 0x05, 0x00, 0x00, 0x00, 0x00, 0x83, 0xc4, 
0x0c, 0x61, 0x8b, 0x45, 0xfc, 0xc9, 0xc2, 0x08, 0x00, 0x60, 0xe8, 0x00, 0x00, 0x00, 0x00, 0x5b, 
0x81, 0xeb, 0x5f, 0x15, 0x40, 0x00, 0xff, 0xb3, 0x73, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xcc, 0x13, 
0x40, 0x00, 0xff, 0xd2, 0x6a, 0x00, 0x8b, 0x93, 0xe0, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x61, 0xc3, 
0xe8, 0x00, 0x00, 0x00, 0x00, 0x5b, 0x81, 0xeb, 0x85, 0x15, 0x40, 0x00, 0x6a, 0x00, 0x8b, 0x93, 
0xf8, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x55, 0x8b, 0xec, 0x83, 0xc4, 0xe4, 0x53, 0x57, 0x56, 0xe8, 
0x00, 0x00, 0x00, 0x00, 0x5b, 0x81, 0xeb, 0xa4, 0x15, 0x40, 0x00, 0x8b, 0x45, 0x0c, 0x83, 0xf8, 
0x01, 0x0f, 0x85, 0xd2, 0x00, 0x00, 0x00, 0x8b, 0x45, 0x08, 0x89, 0x83, 0x73, 0x12, 0x40, 0x00, 
0xb8, 0x2c, 0x10, 0x40, 0x00, 0x03, 0xc3, 0x8b, 0x93, 0x6f, 0x12, 0x40, 0x00, 0xb8, 0x2c, 0x10, 
0x40, 0x00, 0x03, 0xc3, 0x8b, 0x93, 0x6f, 0x12, 0x40, 0x00, 0x53, 0x6a, 0x00, 0x52, 0x6a, 0x06, 
0xff, 0x75, 0x08, 0x6a, 0x14, 0x68, 0x82, 0x00, 0x00, 0x00, 0x6a, 0x20, 0x6a, 0x32, 0x68, 0x20, 
0x00, 0x80, 0x50, 0x6a, 0x00, 0x50, 0x6a, 0x08, 0x8b, 0x93, 0xc4, 0x13, 0x40, 0x00, 0xff, 0xd2, 
0x89, 0x45, 0xec, 0x5b, 0xb8, 0x25, 0x10, 0x40, 0x00, 0x03, 0xc3, 0xb9, 0x31, 0x10, 0x40, 0x00, 
0x03, 0xcb, 0x8b, 0x93, 0x6f, 0x12, 0x40, 0x00, 0x53, 0x6a, 0x00, 0x52, 0x6a, 0x01, 0xff, 0x75, 
0x08, 0x6a, 0x14, 0x6a, 0x32, 0x6a, 0x50, 0x6a, 0x32, 0x68, 0x00, 0x00, 0x00, 0x50, 0x51, 0x50, 
0x6a, 0x00, 0x8b, 0x93, 0xc4, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x45, 0xe8, 0x5b, 0xb8, 0x25, 
0x10, 0x40, 0x00, 0x03, 0xc3, 0xb9, 0x38, 0x10, 0x40, 0x00, 0x03, 0xcb, 0x8b, 0x93, 0x6f, 0x12, 
0x40, 0x00, 0x53, 0x6a, 0x00, 0x52, 0x6a, 0x02, 0xff, 0x75, 0x08, 0x6a, 0x14, 0x6a, 0x32, 0x6a, 
0x50, 0x68, 0x82, 0x00, 0x00, 0x00, 0x68, 0x00, 0x00, 0x00, 0x50, 0x51, 0x50, 0x6a, 0x00, 0x8b, 
0x93, 0xc4, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x45, 0xe4, 0xff, 0x75, 0xec, 0xff, 0x93, 0x08, 
0x14, 0x40, 0x00, 0x5b, 0xe9, 0x84, 0x00, 0x00, 0x00, 0x3d, 0x11, 0x01, 0x00, 0x00, 0x75, 0x5b, 
0x8b, 0x45, 0x10, 0x0f, 0xb7, 0xc0, 0x83, 0xf8, 0x01, 0x75, 0x3f, 0xb8, 0x6f, 0x11, 0x40, 0x00, 
0x03, 0xc3, 0x53, 0x68, 0x00, 0x01, 0x00, 0x00, 0x50, 0x6a, 0x06, 0xff, 0x75, 0x08, 0x8b, 0x93, 
0xd4, 0x13, 0x40, 0x00, 0xff, 0xd2, 0xb8, 0x6f, 0x11, 0x40, 0x00, 0x03, 0xc3, 0xb9, 0x3f, 0x10, 
0x40, 0x00, 0x03, 0xcb, 0x53, 0x51, 0x50, 0x8b, 0x93, 0x04, 0x14, 0x40, 0x00, 0xff, 0xd2, 0x5b, 
0x0b, 0xc0, 0x74, 0x02, 0xeb, 0x09, 0xeb, 0x0c, 0xeb, 0x33, 0x83, 0xf8, 0x02, 0x75, 0x2e, 0xe8, 
0x9c, 0xfe, 0xff, 0xff, 0xe8, 0x70, 0xfe, 0xff, 0xff, 0xeb, 0x22, 0x83, 0xf8, 0x10, 0x75, 0x02, 
0xeb, 0x1b, 0xff, 0x75, 0x14, 0xff, 0x75, 0x10, 0xff, 0x75, 0x0c, 0xff, 0x75, 0x08, 0x8b, 0x93, 
0xc8, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x5e, 0x5f, 0x5b, 0xc9, 0xc2, 0x10, 0x00, 0x33, 0xc0, 0x5e, 
0x5f, 0x5b, 0xc9, 0xc2, 0x10, 0x00, 0x55, 0x8b, 0xec, 0x83, 0xc4, 0xb0, 0x8b, 0x5d, 0x08, 0x53, 
0x6a, 0x00, 0x8b, 0x93, 0xfc, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x5b, 0x89, 0x83, 0x6f, 0x12, 0x40, 
0x00, 0x53, 0x6a, 0x30, 0x8d, 0x45, 0xd0, 0x50, 0x8b, 0x93, 0x00, 0x14, 0x40, 0x00, 0xff, 0xd2, 
0xc7, 0x45, 0xe8, 0x00, 0x00, 0x00, 0x00, 0xc7, 0x45, 0xfc, 0x00, 0x00, 0x00, 0x00, 0xc7, 0x45, 
0xec, 0x00, 0x00, 0x00, 0x00, 0x5b, 0xba, 0x96, 0x15, 0x40, 0x00, 0x03, 0xd3, 0xb9, 0x18, 0x10, 
0x40, 0x00, 0x03, 0xcb, 0xff, 0xb3, 0x6f, 0x12, 0x40, 0x00, 0x8f, 0x45, 0xe4, 0xc7, 0x45, 0xd0, 
0x30, 0x00, 0x00, 0x00, 0xc7, 0x45, 0xd4, 0x03, 0x00, 0x00, 0x00, 0x89, 0x55, 0xd8, 0xc7, 0x45, 
0xf0, 0x05, 0x00, 0x00, 0x00, 0x89, 0x4d, 0xf8, 0x53, 0x8d, 0x45, 0xd0, 0x50, 0x8b, 0x93, 0xe4, 
0x13, 0x40, 0x00, 0xff, 0xd2, 0x5b, 0xba, 0x18, 0x10, 0x40, 0x00, 0x03, 0xd3, 0xb9, 0x05, 0x10, 
0x40, 0x00, 0x03, 0xcb, 0xb8, 0x6f, 0x12, 0x40, 0x00, 0x03, 0xc3, 0x53, 0x6a, 0x00, 0xff, 0x30, 
0x6a, 0x00, 0x6a, 0x00, 0xb8, 0xa0, 0x00, 0x00, 0x00, 0x50, 0xb8, 0xf0, 0x00, 0x00, 0x00, 0x50, 
0xb8, 0x18, 0x01, 0x00, 0x00, 0x50, 0xb8, 0x90, 0x01, 0x00, 0x00, 0x50, 0x68, 0x00, 0x00, 0xc2, 
0x00, 0x51, 0x52, 0x68, 0x00, 0x02, 0x00, 0x00, 0x8b, 0x93, 0xc4, 0x13, 0x40, 0x00, 0xff, 0xd2, 
0x5b, 0x89, 0x83, 0x73, 0x12, 0x40, 0x00, 0xba, 0x73, 0x12, 0x40, 0x00, 0x03, 0xd3, 0x53, 0x52, 
0x6a, 0x01, 0xff, 0x32, 0x8b, 0x8b, 0xe8, 0x13, 0x40, 0x00, 0xff, 0xd1, 0x5a, 0xff, 0x32, 0x8b, 
0x8b, 0xf4, 0x13, 0x40, 0x00, 0xff, 0xd1, 0x5b, 0x53, 0x6a, 0x00, 0x6a, 0x00, 0x6a, 0x00, 0x8d, 
0x45, 0xb4, 0x50, 0x8b, 0x93, 0xd8, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x5b, 0x0b, 0xc0, 0x74, 0x38, 
0xb9, 0x73, 0x12, 0x40, 0x00, 0x03, 0xcb, 0x53, 0x8d, 0x45, 0xb4, 0x50, 0xff, 0x75, 0xb0, 0xff, 
0x31, 0x8b, 0x93, 0xec, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x5b, 0x0b, 0xc0, 0x75, 0x18, 0x8d, 0x45, 
0xb4, 0x50, 0x8b, 0x93, 0xf0, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x8d, 0x45, 0xb4, 0x50, 0x8b, 0x93, 
0xd0, 0x13, 0x40, 0x00, 0xff, 0xd2, 0xeb, 0xb0, 0xc9, 0xc2, 0x04, 0x00, 0x60, 0xe8, 0x00, 0x00, 
0x00, 0x00, 0x5b, 0x81, 0xeb, 0x62, 0x18, 0x40, 0x00, 0x90, 0xb8, 0x65, 0x13, 0x40, 0x00, 0x03, 
0xc3, 0x8b, 0x93, 0xc0, 0x13, 0x40, 0x00, 0x50, 0xff, 0xd2, 0x89, 0x83, 0x7b, 0x12, 0x40, 0x00, 
0x61, 0xc3, 0x60, 0xe8, 0x00, 0x00, 0x00, 0x00, 0x5b, 0x81, 0xeb, 0x88, 0x18, 0x40, 0x00, 0xb8, 
0x9f, 0x12, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7b, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 
0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0xc4, 0x13, 0x40, 0x00, 0xb8, 0xa5, 0x13, 0x40, 0x00, 
0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7b, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 
0xd2, 0x89, 0x83, 0x08, 0x14, 0x40, 0x00, 0xb8, 0xaf, 0x12, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 
0xb3, 0x7b, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0xc8, 
0x13, 0x40, 0x00, 0xb8, 0xbe, 0x12, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7b, 0x12, 0x40, 
0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0xcc, 0x13, 0x40, 0x00, 0xb8, 
0xcc, 0x12, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7b, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 
0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0xd0, 0x13, 0x40, 0x00, 0xb8, 0xdd, 0x12, 0x40, 0x00, 
0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7b, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 
0xd2, 0x89, 0x83, 0xd4, 0x13, 0x40, 0x00, 0xb8, 0xed, 0x12, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 
0xb3, 0x7b, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0xd8, 
0x13, 0x40, 0x00, 0xb8, 0xf9, 0x12, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7b, 0x12, 0x40, 
0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0xdc, 0x13, 0x40, 0x00, 0xb8, 
0x05, 0x13, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7b, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 
0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0xe0, 0x13, 0x40, 0x00, 0xb8, 0x15, 0x13, 0x40, 0x00, 
0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7b, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 
0xd2, 0x89, 0x83, 0xe4, 0x13, 0x40, 0x00, 0xb8, 0x26, 0x13, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 
0xb3, 0x7b, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0xe8, 
0x13, 0x40, 0x00, 0xb8, 0x31, 0x13, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7b, 0x12, 0x40, 
0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0xec, 0x13, 0x40, 0x00, 0xb8, 
0x47, 0x13, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7b, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 
0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0xf0, 0x13, 0x40, 0x00, 0xb8, 0x58, 0x13, 0x40, 0x00, 
0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7b, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 
0xd2, 0x89, 0x83, 0xf4, 0x13, 0x40, 0x00, 0xb8, 0x71, 0x13, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 
0xb3, 0x7f, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0xf8, 
0x13, 0x40, 0x00, 0xb8, 0x7d, 0x13, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7f, 0x12, 0x40, 
0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0xfc, 0x13, 0x40, 0x00, 0xb8, 
0x8e, 0x13, 0x40, 0x00, 0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7f, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 
0x13, 0x40, 0x00, 0xff, 0xd2, 0x89, 0x83, 0x00, 0x14, 0x40, 0x00, 0xb8, 0x9c, 0x13, 0x40, 0x00, 
0x03, 0xc3, 0x50, 0xff, 0xb3, 0x7f, 0x12, 0x40, 0x00, 0x8b, 0x93, 0xbc, 0x13, 0x40, 0x00, 0xff, 
0xd2, 0x89, 0x83, 0x04, 0x14, 0x40, 0x00, 0x61, 0xc3, 0x55, 0x8b, 0xec, 0x60, 0xff, 0x75, 0x08, 
0xe8, 0xa7, 0xf9, 0xff, 0xff, 0x0b, 0xc0, 0x74, 0x19, 0x89, 0x83, 0x7f, 0x12, 0x40, 0x00, 0x8d, 
0x93, 0x83, 0x12, 0x40, 0x00, 0x52, 0x50, 0xe8, 0x00, 0xfa, 0xff, 0xff, 0x89, 0x83, 0xbc, 0x13, 
0x40, 0x00, 0x0b, 0xc0, 0x74, 0x2d, 0x8d, 0x93, 0x92, 0x12, 0x40, 0x00, 0x52, 0xff, 0xb3, 0x7f, 
0x12, 0x40, 0x00, 0xff, 0x93, 0xbc, 0x13, 0x40, 0x00, 0x0b, 0xc0, 0x74, 0x16, 0x89, 0x83, 0xc0, 
0x13, 0x40, 0x00, 0xe8, 0x84, 0xfd, 0xff, 0xff, 0xe8, 0xa5, 0xfd, 0xff, 0xff, 0x53, 0xe8, 0x33, 
0xfc, 0xff, 0xff, 0x61, 0x33, 0xc0, 0xc9, 0xc2, 0x04, 0x00, 0x8b, 0x14, 0x24, 0xe8, 0x00, 0x00, 
0x00, 0x00, 0x5b, 0x81, 0xeb, 0xf2, 0x1a, 0x40, 0x00, 0x52, 0xe8, 0x8a, 0xff, 0xff, 0xff, 0xe9,
0xf0, 0xff, 0xff, 0xff, 0xc3, //0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
//0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 

};

#define PASS_OFFSET 0x3F


//添加代码到一个新区块
//参数---lpCOdeStart:指向代码起始处	dwCodeSize:添加代码的大小
static BOOL _stdcall AddToNewSection(TCHAR szNewFile[], char PASS[])
{
	PIMAGE_NT_HEADERS		lpNtHeaders;
	PIMAGE_SECTION_HEADER	lpSectionHeader;
	PIMAGE_SECTION_HEADER	lpLastSectionHeader;
	DWORD					dwNewFileSize;		//最终文件大小
	DWORD					dwPatchSectionSize; //内存中补丁区块的大小
	DWORD					dwPatchFileSize;	//补丁区段文件中大小
	DWORD					dwFileAlign;		//文件对齐粒度
	DWORD					dwSectionAlign;		//内存对齐粒度
	PBYTE					g_lpNewFile;		//最终文件缓存
	DWORD					g_dwFileSize;
	DWORD					dwSectionNum;
	DWORD					dwNewHeaderSize;	//新头部大小
	DWORD					dwOldHeaderSize;	//老头部大小
	DWORD					dwSectionSize;		//内存中所有区块总大小
	BOOL					bChange = FALSE;	//指示新节表的加入是否影响到文件头大小，如有影响，则需修正各区段偏移
	DWORD					dwCodeSize;

	HANDLE					hFile, hMap;
	PBYTE					g_lpBuffer;
	if (INVALID_HANDLE_VALUE != (hFile = CreateFile (szNewFile, GENERIC_READ, FILE_SHARE_READ, 0, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0) ) )
	{
		g_dwFileSize	 = GetFileSize (hFile, NULL);
		if (g_dwFileSize)
		{
			hMap	= CreateFileMapping (hFile, NULL, PAGE_READONLY, 0, 0, NULL);
			if (hMap)
			{
				g_lpBuffer	= (BYTE *)MapViewOfFile (hMap, FILE_MAP_READ, 0, 0, 0);
				if (!g_lpBuffer)
				{
					CloseHandle (hMap);
					CloseHandle (hFile);
					return FALSE;
				}
			}
			else { CloseHandle (hFile); return FALSE; }
		}
		else  { CloseHandle (hFile); return FALSE;}
	}
	else  return FALSE;
	
	lpNtHeaders			= (PIMAGE_NT_HEADERS)(g_lpBuffer + ((PIMAGE_DOS_HEADER)g_lpBuffer)->e_lfanew);
	lpSectionHeader		= (PIMAGE_SECTION_HEADER)(lpNtHeaders + 1);
	dwSectionNum		= lpNtHeaders->FileHeader.NumberOfSections;
	lpLastSectionHeader	= lpSectionHeader + dwSectionNum - 1;
	dwFileAlign			= lpNtHeaders->OptionalHeader.FileAlignment;
	dwSectionAlign		= lpNtHeaders->OptionalHeader.SectionAlignment;
	dwOldHeaderSize		= lpSectionHeader->PointerToRawData;

	dwSectionSize		= Align(lpLastSectionHeader->VirtualAddress + lpLastSectionHeader->Misc.VirtualSize - Align(dwOldHeaderSize, dwSectionAlign), dwSectionAlign);  //内存中区段总大小
	dwCodeSize			= sizeof(lpCodeStart);

	//获得补丁相关数据
	dwPatchSectionSize	= Align(dwCodeSize, dwSectionAlign);	//内存中新区段对齐大小
	dwPatchFileSize		= Align(dwCodeSize, dwFileAlign);		//文件中新区段对齐大小
	
	//头部是否能增加一个节表
	DWORD	dwValidSize;	//头部当前有效大小
	dwValidSize			= sizeof(IMAGE_NT_HEADERS) + sizeof(IMAGE_SECTION_HEADER)*(dwSectionNum + 1) + ((PIMAGE_DOS_HEADER)g_lpBuffer)->e_lfanew ;
	if ( Align(dwValidSize + sizeof(IMAGE_SECTION_HEADER), dwFileAlign) > 0x1000 )  
		return FALSE;

	//是否要增加头部大小
	dwNewHeaderSize		= Align(dwValidSize + sizeof(IMAGE_SECTION_HEADER), dwFileAlign); //新头部大小
	if (dwNewHeaderSize > Align(dwValidSize, dwFileAlign) )
		bChange	= TRUE;   //记录头部增加，后面需要修改所有节表偏移

	dwNewFileSize		= Align (Align(g_dwFileSize, dwFileAlign) + dwPatchFileSize, dwFileAlign);
	g_lpNewFile			= (PBYTE)VirtualAlloc (NULL, dwNewFileSize, MEM_COMMIT, PAGE_READWRITE);

	if ( !g_lpNewFile )  //分配内存失败
		return FALSE;

	//复制原文件数据
	memset(g_lpNewFile, 0, dwNewFileSize);
	memcpy(g_lpNewFile, g_lpBuffer, dwValidSize);	//头部数据复制

	//区段数据复制
	DWORD	dwSize		= lpLastSectionHeader->PointerToRawData + lpLastSectionHeader->SizeOfRawData - dwOldHeaderSize; //文件中所有区段总大小
	memcpy(g_lpNewFile + dwNewHeaderSize, g_lpBuffer + lpSectionHeader->PointerToRawData, dwSize);
	
	//复制完毕，关闭文件
	UnmapViewOfFile (g_lpBuffer);
	CloseHandle (hMap);
	CloseHandle (hFile);

	//补丁数据复制
	try {
		memcpy(g_lpNewFile + dwNewHeaderSize + dwSize, lpCodeStart, dwCodeSize);
	}
	catch(...)
	{
		return FALSE;
	}


	//开始修正PE头
	PIMAGE_NT_HEADERS		lpNewNtHeaders;
	PIMAGE_SECTION_HEADER	lpNewSectionHeader;
	PIMAGE_SECTION_HEADER	lpNewLastSection;
	DWORD*					lpNewEntry;			//指向新入口处
	DWORD					OldEntry;

	lpNewNtHeaders		= (PIMAGE_NT_HEADERS)( g_lpNewFile + ((PIMAGE_DOS_HEADER)g_lpNewFile)->e_lfanew);
	lpNewSectionHeader	= (PIMAGE_SECTION_HEADER) (lpNewNtHeaders + 1);
	lpNewLastSection	= lpNewSectionHeader + dwSectionNum; //此处即指向要创建的新区段
	
	lpNewNtHeaders->FileHeader.NumberOfSections	   += 1; //添加一个区段
	lpNewNtHeaders->OptionalHeader.SizeOfHeaders	= dwNewHeaderSize;
	lpNewNtHeaders->OptionalHeader.SizeOfImage		= dwNewHeaderSize + dwSectionSize + dwPatchSectionSize; //镜像总大小
	
	//根据需要修正节表偏移
	if (bChange)
	{
		PIMAGE_SECTION_HEADER	lpTempSection = lpNewSectionHeader;
		DWORD	dwOffset	= dwNewHeaderSize - dwOldHeaderSize;
		for (DWORD i=0; i < dwSectionNum; i++, lpTempSection++ )
		{
			lpTempSection->PointerToRawData += dwOffset;
		}
	}

	//建立一个新节表
	lpNewLastSection->Characteristics	= 0xC0000020; //读写执行属性添加
	lpNewLastSection->VirtualAddress	= Align(dwNewHeaderSize, dwSectionAlign) + dwSectionSize;
	lpNewLastSection->Misc.VirtualSize	= dwPatchSectionSize;
	lpNewLastSection->PointerToRawData	= dwNewHeaderSize + dwSize;
	lpNewLastSection->SizeOfRawData		= dwPatchFileSize;
	lstrcpyA( (LPSTR)(lpNewLastSection->Name), ".cdata");


	//修正入口地址
	OldEntry		= lpNewNtHeaders->OptionalHeader.AddressOfEntryPoint;
	lpNewNtHeaders->OptionalHeader.AddressOfEntryPoint	= Align(dwNewHeaderSize, dwSectionAlign) + dwSectionSize ;
	
	//修正补丁代码跳回OEP的参数
	lpNewEntry			= (DWORD*)(g_lpNewFile + dwNewHeaderSize + dwSize + dwCodeSize - 5);
	*lpNewEntry			= OldEntry - (lpNewNtHeaders->OptionalHeader.AddressOfEntryPoint + dwCodeSize - 1); 

	//修改密码参数
	lstrcpyA( (LPSTR)(g_lpNewFile + lpNewLastSection->PointerToRawData) + PASS_OFFSET, PASS);

	//补丁完毕，写回文件
	HANDLE  hNewFile;
	DWORD	dwRead;
	if (INVALID_HANDLE_VALUE == ( hNewFile = CreateFile (szNewFile, GENERIC_READ | GENERIC_WRITE , FILE_SHARE_READ , NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_ARCHIVE, NULL) ) )
	{
		VirtualFree(g_lpNewFile, dwNewFileSize, MEM_RELEASE);
		g_lpNewFile	= NULL;
		return FALSE;
	}

	WriteFile(hNewFile, g_lpNewFile, dwNewFileSize, &dwRead, NULL);
	CloseHandle(hNewFile);

	//释放内存
	VirtualFree(g_lpNewFile, dwNewFileSize, MEM_RELEASE);
	g_lpNewFile	= NULL;
	return TRUE;
}


BOOL PE_Lock(TCHAR szFileName[], TCHAR PASSWORD[])
{
	TCHAR szBakFileName[MAX_PATH];

	//进行文件备份
	lstrcpy(szBakFileName,szFileName);
	lstrcat(szBakFileName,TEXT(".bak") );
	CopyFile(szFileName,szBakFileName,TRUE);
	char PASS[32];
	WideCharToMultiByte (CP_ACP, 0, (PWSTR) PASSWORD, -1, PASS, WideCharToMultiByte( CP_ACP, 0, PASSWORD, -1, NULL, 0, NULL, NULL)\
																				, NULL, NULL) ;
	return AddToNewSection(szFileName, PASS );
}


//检测是否是PE文件
BOOL _stdcall IsPeFile(TCHAR szFileName[])
{
	HANDLE	hFile;
	WORD	wMagic;
	DWORD   dwRead,dw;
	if (INVALID_HANDLE_VALUE != ( hFile = CreateFile (szFileName, GENERIC_READ, FILE_SHARE_READ | FILE_SHARE_WRITE, \
																		NULL, OPEN_EXISTING, FILE_ATTRIBUTE_ARCHIVE, NULL) ) )
	{
		ReadFile(hFile , &wMagic, 2, &dwRead, NULL);
		if ( wMagic == 0x5A4D)
		{
			SetFilePointer(hFile, 0x3C, 0, FILE_BEGIN);
			ReadFile(hFile , &dw, 4, &dwRead, NULL);
			SetFilePointer(hFile, dw, 0, FILE_BEGIN);
			ReadFile(hFile , &wMagic, 2, &dwRead, NULL);
			if (wMagic == 0x4550)
			{
				CloseHandle(hFile);
				return TRUE;
			}
		}
		CloseHandle(hFile);
	}
	return FALSE;
}


#endif